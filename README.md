# RailwaysObjectDetection

Модель Object Detection для обнаружения рабочих, касок и жилеток на железной дороге. 

Предоставлена выборка размером 3221 фотографий. Число классов равно 3 (рабочий, жилет, каска)

Модель обучалась на 80 процентах изображений от общей выборки. 20 процентов использовалось для валидации 
Достигнутая точность: 

```
class_id = 0, name = 0, ap = 79.41%   	 (TP = 1458, FP = 2526) 
class_id = 1, name = 1, ap = 83.60%   	 (TP = 1185, FP = 1399) 
class_id = 2, name = 2, ap = 97.10%   	 (TP = 1550, FP = 1841) 
```

Для обучения использовалась модель YOLOV4. 
Конфигурационный файл модели был изменен. Указано число классов (3), разрешение изображений (800, 800), а так же число шагов обучения, размер max_batches, число фильтров на выходе сети и др. 
---------

# График обучения сети

![image](https://user-images.githubusercontent.com/29977757/196161975-1617a208-f295-45af-abf5-4e3b2005583b.png)

---------
# Визуализация результатов
Взяты анкоры с вероятностью выше 90 процентов

![image](https://user-images.githubusercontent.com/29977757/196162072-1e838b10-80ed-493f-a861-b376eef4a627.png)
![image](https://user-images.githubusercontent.com/29977757/196163987-ab034f9b-51ec-4793-b9e4-8e2823eb75d1.png)

---------

В файле main.py создан класс Model, который получает при инициализации конфиг (состоящий из файлов: конфигурации модели, весов модели, информации об обучающих данных, названий классов). Метод predict на вход получает изображение и сохраняет в директорию проекта файл prediction.jpg

Пример запуска функции есть в файле main.py
```
config = {'obj.data': 'obj.data', 
       'cfg':'yolov4-obj.cfg',
       'weights': 'yolov4-obj_best.weights', 
       'thresh': 0.9}
       
model = ObDetModel(config)
model.predict('1657.jpg')
```

Веса можно скачать здесь:
https://drive.google.com/file/d/1-1WlEnwuXrAf3dlufw1Moyxhv3YRunz3/view?usp=sharing

P.S. Обычно подобного рода проекты я оформляю как сервис и заворачиваю в Docker-контейнер. Решил не делать так в этот раз, потому что этого не требовалось в задании. Кроме того, фреймворк Darknet засчет исполнительного файла сводит необходимость предустановки бибилиотек к минимуму. Данный репозиторий работает на любой исполнительной машине, где имеется GPU Nvidia (не сильно слабой производительности. Пойдут карты от 1050) с доступными CUDA ядрами и установленными библиотеками видео-карты. 
